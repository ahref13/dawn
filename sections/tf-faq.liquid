{% comment %} THE FALL – FAQ - Tailwind Grid {% endcomment %}

<section class="min-h-[92vh] w-full grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 px-[20px] md:px-[30px] lg:px-[50px] gap-[15px] md:gap-[20px] lg:gap-[40px] pt-[130px] pb-[60px] bg-[#CFCAC6]">

  <!-- General FAQs Heading -->
  <div class="col-span-2 font-sm">
    <div class="uppercase mb-8">{{ section.settings.heading }}</div>
  </div>

  <!-- General FAQs List -->
  <div class="col-span-2 col-start-1 md:col-span-2 md:col-start-3 lg:col-span-3 lg:col-start-4 xl:col-span-3 xl:col-start-5">
    <ul class="list-none p-0 m-0">
      {% assign index = 0 %}
      {% for block in section.blocks %}
        {% if block.settings.faq_group == 'general' %}
          {% assign index = index | plus: 1 %}
          <li class="flex flex-col gap-4 mb-4" data-faq-item>
            <div class="flex items-start gap-4 cursor-pointer" data-faq-toggle>
              <div class="font-xs flex-shrink-0 pt-1">
                {% if index < 10 %}{{ index | prepend: '0' }}{% else %}{{ index }}{% endif %}
              </div>
              <div class="font-base flex-1">{{ block.settings.title }}</div>
              <div class="text-[18px] select-none transition-transform duration-300" aria-hidden="true">+</div>
            </div>
            <div class="max-h-0 overflow-hidden transition-[max-height] duration-400 ease-in-out" data-faq-body>
              <p class="font-sm ml-8 mt-0 mb-10">{{ block.settings.description }}</p>
            </div>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>

  <!-- Resale FAQs Heading -->
  <div class="col-span-2 font-sm mt-12">
    <div class="uppercase mb-8">{{ section.settings.heading_2 }}</div>
  </div>

  <!-- Resale FAQs List -->
  <div class="col-span-2 col-start-1 md:col-span-2 md:col-start-3 lg:col-span-3 lg:col-start-4 xl:col-span-3 xl:col-start-5 mt-12">
    <ul class="list-none p-0 m-0">
      {% assign index = 0 %}
      {% for block in section.blocks %}
        {% if block.settings.faq_group == 'resale' %}
          {% assign index = index | plus: 1 %}
          <li class="flex flex-col gap-4 mb-4" data-faq-item>
            <div class="flex items-start gap-4 cursor-pointer" data-faq-toggle>
              <div class="font-xs flex-shrink-0 pt-1">
                {% if index < 10 %}{{ index | prepend: '0' }}{% else %}{{ index }}{% endif %}
              </div>
              <div class="font-base flex-1">{{ block.settings.title }}</div>
              <div class="text-[18px] select-none transition-transform duration-300" aria-hidden="true">+</div>
            </div>
            <div class="max-h-0 overflow-hidden transition-[max-height] duration-400 ease-in-out" data-faq-body>
              <p class="font-sm ml-8 mt-0 mb-10">{{ block.settings.description }}</p>
            </div>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>

</section>

<style>
  /* Active state styles */
  [data-faq-item].active [data-faq-body] {
    max-height: 500px;
  }

  [data-faq-item].active .text-\[18px\] {
    transform: rotate(45deg);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const faqToggles = document.querySelectorAll('[data-faq-toggle]');

    faqToggles.forEach(toggle => {
      toggle.addEventListener('click', () => {
        const item = toggle.closest('[data-faq-item]');
        const isOpen = item.classList.contains('active');

        // Close all other items
        document.querySelectorAll('[data-faq-item]').forEach(el => {
          el.classList.remove('active');
          const btn = el.querySelector('[data-faq-toggle]');
          if (btn) btn.setAttribute('aria-expanded', 'false');
        });

        // Toggle current item
        if (!isOpen) {
          item.classList.add('active');
          toggle.setAttribute('aria-expanded', 'true');
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "TF • FAQ",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "General FAQs Heading",
      "default": "GENERAL FAQs"
    },
    {
      "type": "text",
      "id": "heading_2",
      "label": "Resale FAQs Heading",
      "default": "RESALE FAQs"
    }
  ],
  "blocks": [
    {
      "type": "faq",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "select",
          "id": "faq_group",
          "label": "FAQ Group",
          "options": [
            { "value": "general", "label": "General" },
            { "value": "resale", "label": "Resale" }
          ],
          "default": "general"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Sample question"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Answer",
          "default": "Sample answer content."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "TF • FAQ",
      "blocks": [
        {
          "type": "faq",
          "settings": {
            "faq_group": "general",
            "title": "When should I start shopping?",
            "description": "We recommend starting shopping up to a year prior..."
          }
        },
        {
          "type": "faq",
          "settings": {
            "faq_group": "resale",
            "title": "Is resale right for me?",
            "description": "Resale dresses are perfect if you're looking for value and sustainability."
          }
        }
      ]
    }
  ]
}
{% endschema %}
